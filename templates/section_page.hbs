<div class="container-divider"></div>
<div class="container-divider"></div>
<div class="container">
  <nav class="sub-nav">
    {{breadcrumbs}}
  </nav>

  <!-- Start of two-column layout with a gap between the boxes -->
  <div class="flex-container"> <!-- Flex container that holds both aside and main content -->
    
    <!-- Sidebar -->
    <aside id="sections-list" class="sidebar-box">
      <!-- Search Box -->
      <div class="search-box">
        <input type="text" placeholder="Search sections..." class="search-input">
      </div>

      <h3 class="collapsible-sidebar-title sidenav-title">Support Hub</h3>

      <!-- Sidebar content -->
      <div class="sidebar-content">
        <!-- Dynamically inject sections here -->
        <ul id="sections-sidebar" class="sections-list">
          <!-- Sections will be dynamically loaded via JavaScript -->
        </ul>
      </div>
    </aside>

    <!-- Main content area with grey border and left-aligned text -->
    <div class="main-content-box">
      <section id="main-content" class="section-content">
        <header class="page-header">
          <h1>{{section.name}}</h1>
          {{#if section.description}}
            <p class="page-header-description">{{section.description}}</p>
          {{/if}}
        </header>

        <!-- Articles list -->
        {{#if section.articles}}
          <ul class="articles-list">
            {{#each section.articles}}
            <li class="article-item">
              <a href="{{url}}" class="article-link">
                {{title}}
                <!-- Arrow icon aligned to the right -->
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" focusable="false" viewBox="0 0 16 16" aria-hidden="true">
                  <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5 14.5l6.1-6.1c.2-.2.2-.5 0-.7L5 1.5"/>
                </svg>
              </a>
            </li>
            {{/each}}
          </ul>
        {{else}}
          <i class="section-empty">No articles available.</i>
        {{/if}}
      </section>
    </div>
  </div>

  <!-- Box for the Back to Support Page Link outside the flex container -->
  <div class="support-box">
    <a href="/support" class="text-blue-600 hover:text-blue-400 block text-center">Back to Support Page</a>
  </div>

</div>




<!-- JavaScript to Fetch and Inject Sections -->
<script>
  $(document).ready(function() {
    var url = window.location.href;
    var categoryIdMatch = url.match(/categories\/(\d+)/); 
    var categoryId = categoryIdMatch ? categoryIdMatch[1] : null;

    if (categoryId) {
      $.getJSON('/api/v2/help_center/en-us/categories/' + categoryId + '/sections.json', function(data) {
        var sectionsList = '';
        if (data.sections.length > 0) {
          $.each(data.sections, function(index, section) {
            sectionsList += '<li class="section-item">' +
                            '<a href="' + section.html_url + '" class="section-link">' + section.name +
                            '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="icon-right">' +
                            '<path d="M8 0C6.346 0 5 1.346 5 3s1.346 3 3 3 3-1.346 3-3S9.654 0 8 0zm0 4.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"/>' +
                            '</svg>' +
                            '</a>' +
                            '</li>';
          });
          $('#sections-sidebar').html(sectionsList);
          $('#no-sections-message').hide(); 
        } else {
          $('#no-sections-message').show();
        }
      });
    } else {
      $('#no-sections-message').text('Category ID not found').show();
    }
  });
</script>

<!-- Add Vanilla CSS -->
<style>
.flex-container {
  display: flex;
  gap: 20px;
}

.sidebar-box {
  width: 25%;
  padding: 16px;
  background-color: white;
  border: 1px solid #d1d5db;
  text-align: left;
}

.main-content-box {
  width: 75%;
  padding: 16px;
  background-color: white;
  border: 1px solid #d1d5db;
}

.search-box {
  margin-bottom: 16px;
}

.search-input {
  width: 100%;
  padding: 8px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
}

.sections-list {
  list-style-type: none;
  padding: 0;
}

.section-item {
  padding: 12px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background-color: white;
  border: 1px solid #d1d5db;
  margin-bottom: 10px;
  transition: border 0.3s;
}

.section-item:hover {
  border-top: 2px solid #d1d5db;
  border-bottom: 2px solid #d1d5db;
}

.icon-right {
  margin-left: 8px;
}

.section-link {
  color: #4b5563;
  text-decoration: none;
  flex-grow: 1;
  text-align: left;
}

.section-link:hover {
  color: #374151;
  border-top:1px solid #374151;
  border-bottom:1px solid #374151;
}

/* Support Box outside of flex container */
.support-box {
  width: 100%; /* Make it stretch across full width */
  margin-top: 16px;
  padding: 12px;
  background-color: white;
  border: 1px solid #d1d5db;
  text-align: center;
  border-radius: 4px;
}

</style>
