<div class="container-divider"></div>
<div class="container">
  <nav class="sub-nav">
    {{breadcrumbs}}
  </nav>

  <!-- Start of two-column layout with a gap between the boxes -->
  <div class="flex gap-6">

    <!-- Sidebar in a box with grey borders and left-aligned text -->
    <aside id="sections-list" class="w-1/4 p-4 bg-white border border-gray-300">
      <h3 class="collapsible-sidebar-title sidenav-title mb-4 p-4 bg-gray-200 text-left">Sections</h3>

      <!-- Dynamically inject sections here -->
      <ul id="sections-sidebar" class="space-y-4 text-left">
        <!-- Sections will be dynamically loaded via JavaScript -->
      </ul>

      <p id="no-sections-message" class="text-red-500" style="display:none;">No sections available</p>
    </aside>

    <!-- Main content area with grey border and left-aligned text -->
    <div class="w-3/4 pl-4 bg-white border border-gray-300">
      <section id="main-content" class="section-content p-4">
        <header class="page-header mb-6 p-4 bg-gray-200 text-left">
          <h1 class="text-2xl font-bold">{{section.name}}</h1>
          {{#if section.description}}
            <p class="page-header-description">{{section.description}}</p>
          {{/if}}
        </header>

        <!-- Articles list -->
        {{#if section.articles}}
          <ul class="space-y-2 mb-6 text-left">
            {{#each section.articles}}
            <li class="border-b border-gray-300 pb-2">
              <a href="{{url}}" class="text-gray-800 hover:text-gray-600 flex justify-between items-center">
                {{title}}
                <!-- Arrow icon aligned to the right -->
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" focusable="false" viewBox="0 0 16 16" aria-hidden="true">
                  <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5 14.5l6.1-6.1c.2-.2.2-.5 0-.7L5 1.5"/>
                </svg>
              </a>
            </li>
            {{/each}}
          </ul>
        {{else}}
          <i class="section-empty">No articles available.</i>
        {{/if}}

      </section>
    </div>
  </div>
</div>

<!-- JavaScript to Fetch and Inject Sections -->
<script>
  $(document).ready(function() {
    // Extract category ID from the URL (assumes URL pattern has category_id in it, e.g., /categories/{category_id})
    var url = window.location.href;
    var categoryIdMatch = url.match(/categories\/(\d+)/); // Adjust regex as per your URL structure
    var categoryId = categoryIdMatch ? categoryIdMatch[1] : null;

    if (categoryId) {
      // Fetch sections dynamically via API
      $.getJSON('/api/v2/help_center/en-us/categories/' + categoryId + '/sections.json', function(data) {
        var sectionsList = '';
        if (data.sections.length > 0) {
          $.each(data.sections, function(index, section) {
            sectionsList += '<li class="p-4 bg-white hover:border-t-2 hover:border-b-2 active:border-t-2 active:border-b-2 border-gray-300 text-left">' +
                            '<a href="' + section.html_url + '" class="text-gray-800 hover:text-gray-600">' + section.name + '</a>' +
                            '</li>';
          });
          $('#sections-sidebar').html(sectionsList);
        } else {
          $('#no-sections-message').show();
        }
      });
    } else {
      $('#no-sections-message').text('Category ID not found').show();
    }
  });
</script>

